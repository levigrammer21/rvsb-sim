<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Red vs Blue ‚Äì Pok√©mon Battle Tournament</title>

<style>
body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background: #0b0b0b;
  color: #eee;
}
header {
  padding: 12px;
  text-align: center;
  background: linear-gradient(90deg, #b30000, #0033cc);
  font-weight: 900;
}
main { padding: 12px; max-width: 1100px; margin: auto; }

.row { display: flex; gap: 8px; flex-wrap: wrap; align-items: center; }
button, select, input {
  background: #1e1e1e;
  color: #fff;
  border: 1px solid #333;
  border-radius: 8px;
  padding: 6px 10px;
}
button:hover { background:#2a2a2a; cursor:pointer; }

.panel {
  border: 1px solid #222;
  border-radius: 12px;
  padding: 10px;
  margin: 10px 0;
  background: #111;
}

.teamHeader {
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-weight:800;
}

.ballsRow { display:flex; gap:6px; margin-top:6px; }
.ball {
  width:14px;height:14px;border-radius:50%;
  border:1px solid #555;background:#eee;
  position:relative;
}
.ball:after {
  content:"";position:absolute;left:50%;top:50%;
  width:100%;height:2px;background:#555;
  transform:translate(-50%,-50%);
}
.ball.fainted { background:#444; opacity:.5; }

#log {
  white-space: pre-wrap;
  font-family: monospace;
  background:#000;
  padding:10px;
  border-radius:8px;
  height:220px;
  overflow:auto;
}

.bracket {
  display:flex;
  gap:20px;
  overflow-x:auto;
}
.round {
  min-width:180px;
}
.match {
  border:1px solid #333;
  border-radius:8px;
  padding:6px;
  margin-bottom:10px;
}
.match .winner {
  font-weight:900;
  color:#7CFC00;
}

.modal {
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.85);
  display:flex;
  align-items:center;
  justify-content:center;
}
.modal.hidden { display:none; }
.modalContent {
  background:#111;
  border-radius:14px;
  padding:14px;
  max-width:90%;
  max-height:90%;
  overflow:auto;
}
</style>
</head>

<body>
<header>üèÜ Pok√©mon Battle Tournament Simulator</header>

<main>

<div class="panel row">
  <input id="redName" placeholder="Red Team Name" value="Red"/>
  <input id="blueName" placeholder="Blue Team Name" value="Blue"/>
  <button id="ttsBtn">üéôÔ∏è Announcer OFF</button>
  <select id="voiceSelect"></select>
  <select id="speedSelect">
    <option value="1200">Slow</option>
    <option value="700" selected>Normal</option>
    <option value="300">Fast</option>
  </select>
</div>

<div class="panel row">
  <button id="simBtn">‚öîÔ∏è Battle</button>
  <button id="tournamentBtn">üèÜ Tournament</button>
  <select id="tournamentSize">
    <option value="4">4 Teams</option>
    <option value="8" selected>8 Teams</option>
    <option value="16">16 Teams</option>
  </select>
</div>

<div class="panel">
  <div class="teamHeader">
    <span id="redTitle">Red</span>
    <span id="redCount"></span>
  </div>
  <div id="redBalls" class="ballsRow"></div>
</div>

<div class="panel">
  <div class="teamHeader">
    <span id="blueTitle">Blue</span>
    <span id="blueCount"></span>
  </div>
  <div id="blueBalls" class="ballsRow"></div>
</div>

<div class="panel">
  <strong>Battle Log</strong>
  <div id="log"></div>
</div>

<div class="panel">
  <strong>Tournament Bracket</strong>
  <div id="bracket" class="bracket"></div>
</div>

</main>

<div id="modal" class="modal hidden">
  <div class="modalContent">
    <button onclick="modal.classList.add('hidden')">Close</button>
    <div id="modalBody"></div>
  </div>
</div>

<script>
/* ================================
   CORE UTILITIES
================================ */
const $ = id => document.getElementById(id);
const log = (msg, speakIt=true)=>{
  $("log").textContent += msg+"\\n";
  $("log").scrollTop = $("log").scrollHeight;
  if (speakIt) speak(msg);
};

/* ================================
   TEXT TO SPEECH ‚Äì SPORTS ANNOUNCER
================================ */
let TTS=false, voice=null;
function loadVoices(){
  const list = speechSynthesis.getVoices();
  $("voiceSelect").innerHTML="";
  list.forEach((v,i)=>{
    const o=document.createElement("option");
    o.value=i; o.textContent=`${v.name} (${v.lang})`;
    $("voiceSelect").appendChild(o);
  });
  voice=list[0];
}
speechSynthesis.onvoiceschanged=loadVoices;

function speak(text){
  if(!TTS||!voice)return;
  const u=new SpeechSynthesisUtterance(text);
  u.voice=voice;
  u.rate=0.95;
  u.pitch=1.05;
  speechSynthesis.speak(u);
}

/* ================================
   UI LOGIC
================================ */
$("ttsBtn").onclick=()=>{
  TTS=!TTS;
  $("ttsBtn").textContent=TTS?"üéôÔ∏è Announcer ON":"üéôÔ∏è Announcer OFF";
};
$("voiceSelect").onchange=e=>{
  voice=speechSynthesis.getVoices()[e.target.value];
};
$("speedSelect").onchange=e=>TICK=+e.target.value;

let TICK=700;

/* ================================
   FAKE BATTLE ENGINE (STABLE)
================================ */
function fakeTeam(name){
  return { name, alive:6 };
}
function renderBalls(el, alive){
  el.innerHTML="";
  for(let i=0;i<6;i++){
    const d=document.createElement("div");
    d.className="ball"+(i>=alive?" fainted":"");
    el.appendChild(d);
  }
}

function battle(red, blue){
  renderBalls($("redBalls"),6);
  renderBalls($("blueBalls"),6);
  let turn=1;
  const interval=setInterval(()=>{
    if(red.alive<=0||blue.alive<=0){
      clearInterval(interval);
      const win=red.alive>0?red.name:blue.name;
      log(`üèÅ ${win} wins the battle!`);
      return;
    }
    log(`Turn ${turn}: The crowd roars!`);
    if(Math.random()<0.5){ blue.alive--; }
    else { red.alive--; }
    renderBalls($("redBalls"),red.alive);
    renderBalls($("blueBalls"),blue.alive);
    turn++;
  },TICK);
}

/* ================================
   TOURNAMENT + BRACKET
================================ */
function runTournament(){
  const size=+$("tournamentSize").value;
  const teams=[];
  for(let i=0;i<size;i++) teams.push({name:`Team ${i+1}`});
  const bracket=$("bracket");
  bracket.innerHTML="";
  let round=1;
  let current=teams;

  while(current.length>1){
    const col=document.createElement("div");
    col.className="round";
    col.innerHTML=`<strong>Round ${round}</strong>`;
    const next=[];
    for(let i=0;i<current.length;i+=2){
      const a=current[i], b=current[i+1];
      const win=Math.random()<0.5?a:b;
      const div=document.createElement("div");
      div.className="match";
      div.innerHTML=`${a.name} vs ${b.name}<div class="winner">Winner: ${win.name}</div>`;
      col.appendChild(div);
      next.push(win);
    }
    bracket.appendChild(col);
    current=next;
    round++;
  }
  log(`üèÜ TOURNAMENT CHAMPION: ${current[0].name}`);
}

/* ================================
   BUTTONS
================================ */
$("simBtn").onclick=()=>{
  $("log").textContent="";
  const r={name:$("redName").value||"Red",alive:6};
  const b={name:$("blueName").value||"Blue",alive:6};
  $("redTitle").textContent=r.name;
  $("blueTitle").textContent=b.name;
  battle(r,b);
};

$("tournamentBtn").onclick=()=>{
  $("log").textContent="";
  runTournament();
};
</script>
</body>
</html>
